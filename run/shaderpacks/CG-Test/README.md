# CG-Test 光线追踪光影包

一个为 Minecraft Iris 模组生态系统设计的 GPU 光线追踪渲染器。

## 功能特性

- **实时光线追踪**: 支持多次弹射的路径追踪实现
- **高级光照**: 基于物理的光照模型，包含直接和间接光照
- **材质系统**: 支持多种材质类型（金属、电介质、自发光）
- **降噪处理**: 双边滤波和时间累积降噪
- **后期处理**: ACES 色调映射、色差和暗角效果
- **性能优化**: 可配置的质量设置适配不同硬件

## 环境要求

- **Minecraft**: 1.20.4
- **Fabric Loader**: 0.15.6
- **Fabric API**: 0.96.0
- **Iris Shaders**: 1.7.2
- **Sodium**: 0.5.8

⚠️ **重要提示**: 此光影包**仅支持 Iris**，无法在 OptiFine 上运行。

## 安装方法

1. 为 Minecraft 1.20.4 安装 Fabric Loader
2. 下载并安装所需模组（Fabric API、Iris、Sodium）
3. 将光影包文件夹放入 `.minecraft/shaderpacks/` 目录
4. 在游戏中通过 Iris 设置启用光影包

## 配置选项

光影包包含多个可配置选项：

- **光线样本数** (1-4): 每像素光线数量（越高画质越好，性能越低）
- **光线弹射次数** (1-6): 最大光线弹射次数（越高光照越真实）
- **最大距离** (16-256): 光线追踪最大距离（方块单位）
- **漫反射质量** (0-3): 漫反射光照计算质量设置

通过 `composite.fsh` 调整这些设置。

## 技术细节

### 架构设计
- **G-Buffer 通道**: 存储反照率、法线、深度和材质属性
- **延迟渲染通道**: 应用直接光照和环境光遮蔽
- **光线追踪通道**: 执行全局光照的路径追踪
- **后期处理**: 降噪、色调映射和视觉效果

### 缓冲区布局
- `colortex0`: 反照率和透明度
- `colortex1`: 视图空间法线和深度
- `colortex2`: 材质属性（粗糙度、金属度、自发光）
- `colortex3`: 累积的光线追踪结果
- `colortex4`: 最终合成帧

### 支持的材质
- 可配置粗糙度的默认表面
- 带反射的金属材质
- 带光线发射的自发光方块
- 带透明度的水和玻璃
- 植物和有机材质

## 性能建议

- 使用较低的光线样本数（1-2）和较少弹射次数（2-3）
- 降低最大追踪距离以提升性能
- 推荐使用现代GPU（RTX 30/40系列，RX 6000/7000系列）
- 推荐8GB+显存用于高设置

## 已知问题

- 时间抗锯齿（TAA）实现需要优化
- 部分透明效果可能无法正确渲染
- 不同GPU架构间性能差异较大

## 致谢

基于 XorDev 的默认光影包框架。特别感谢 Iris 开发团队提供的优秀模组生态系统。

## 相关链接

- [Iris Shaders](https://irisshaders.net/)
- [Fabric](https://fabricmc.net/)
- [Sodium](https://modrinth.com/mod/sodium)

